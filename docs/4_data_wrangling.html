<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Miguel A. Tripp Valdez">

<title>Tidyverse - LecciÃ³n 2. ManipulaciÃ³n de datos con dplyr</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a href="./index.html" class="navbar-brand navbar-brand-logo">
    <img src="./img/logo.png" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Tidyverse</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html" rel="" target="">
 <span class="menu-text">Inicio</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./about.html" rel="" target="">
 <span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./apoyo.html" rel="" target="">
 <span class="menu-text">Recursos de apoyo</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-secciones" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Secciones</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-secciones">    
        <li>
    <a class="dropdown-item" href="./apoyo.html" rel="" target="">
 <span class="dropdown-text">Recursos de apoyo</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./3_Data_import.html" rel="" target="">
 <span class="dropdown-text">Leccion 1: Importar y limpiar archivos</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com" rel="" target=""><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">LecciÃ³n 2. ManipulaciÃ³n de datos con dplyr</li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation docked overflow-auto">
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
 <span class="menu-text">2_Proyectos.qmd</span>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./3_Data_import.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Leccion 1: Importar y limpiar archivos</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Contenido</h2>
   
  <ul>
  <li><a href="#el-formato-tidy" id="toc-el-formato-tidy" class="nav-link active" data-scroll-target="#el-formato-tidy"><span class="header-section-number">1</span> El formato Tidy</a></li>
  <li><a href="#manipulaciÃ³n-de-datos-con-dplyr" id="toc-manipulaciÃ³n-de-datos-con-dplyr" class="nav-link" data-scroll-target="#manipulaciÃ³n-de-datos-con-dplyr"><span class="header-section-number">2</span> ManipulaciÃ³n de datos con Dplyr</a>
  <ul class="collapse">
  <li><a href="#seleccionar-columnas-con-select" id="toc-seleccionar-columnas-con-select" class="nav-link" data-scroll-target="#seleccionar-columnas-con-select"><span class="header-section-number">2.1</span> Seleccionar columnas con <code>select()</code></a>
  <ul class="collapse">
  <li><a href="#seleccionar-variables-con-un-patrÃ³n" id="toc-seleccionar-variables-con-un-patrÃ³n" class="nav-link" data-scroll-target="#seleccionar-variables-con-un-patrÃ³n"><span class="header-section-number">2.1.1</span> Seleccionar variables con un patrÃ³n</a></li>
  </ul></li>
  <li><a href="#filtrar-variables-con-filter" id="toc-filtrar-variables-con-filter" class="nav-link" data-scroll-target="#filtrar-variables-con-filter"><span class="header-section-number">2.2</span> Filtrar variables con <code>filter()</code></a>
  <ul class="collapse">
  <li><a href="#filtrar-variables-con-un-patrÃ³n" id="toc-filtrar-variables-con-un-patrÃ³n" class="nav-link" data-scroll-target="#filtrar-variables-con-un-patrÃ³n"><span class="header-section-number">2.2.1</span> Filtrar variables con un patrÃ³n</a></li>
  </ul></li>
  <li><a href="#transformar-o-crear-columnas-con-mutate" id="toc-transformar-o-crear-columnas-con-mutate" class="nav-link" data-scroll-target="#transformar-o-crear-columnas-con-mutate"><span class="header-section-number">2.3</span> Transformar o crear columnas con <code>mutate()</code></a></li>
  </ul></li>
  <li><a href="#pipes-y" id="toc-pipes-y" class="nav-link" data-scroll-target="#pipes-y"><span class="header-section-number">3</span> Pipes <em>%&gt;%</em> y <em>|&gt;</em></a></li>
  <li><a href="#resumen-de-los-datos-summarise-y-group_by." id="toc-resumen-de-los-datos-summarise-y-group_by." class="nav-link" data-scroll-target="#resumen-de-los-datos-summarise-y-group_by."><span class="header-section-number">4</span> Resumen de los datos; <code>summarise()</code> y <code>group_by()</code>.</a>
  <ul class="collapse">
  <li><a href="#operaciones-agrupadas" id="toc-operaciones-agrupadas" class="nav-link" data-scroll-target="#operaciones-agrupadas"><span class="header-section-number">4.1</span> Operaciones agrupadas</a></li>
  <li><a href="#resumir-todas-las-variables-con-summarise_all" id="toc-resumir-todas-las-variables-con-summarise_all" class="nav-link" data-scroll-target="#resumir-todas-las-variables-con-summarise_all"><span class="header-section-number">4.2</span> Resumir todas las variables con <code>summarise_all()</code></a></li>
  </ul></li>
  <li><a href="#count" id="toc-count" class="nav-link" data-scroll-target="#count"><span class="header-section-number">5</span> <code>count()</code></a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">LecciÃ³n 2. ManipulaciÃ³n de datos con dplyr</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Miguel A. Tripp Valdez </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<section id="el-formato-tidy" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> El formato Tidy</h1>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/tidydata-messy.jpg" class="img-fluid figure-img" width="582"></p>
</figure>
</div>
<p>Tidy Data es un concepto fundamental dentro del ecosistema Tidyverse en R que se centra en la organizaciÃ³n y manipulaciÃ³n eficiente de datos para anÃ¡lisis y visualizaciÃ³n.</p>
<p>En el contexto de Tidy Data, se busca estructurar los conjuntos de datos de manera que cada observaciÃ³n sea una fila, cada variable sea una columna y cada valor tenga su propia celda. Esto permite que los datos estÃ©n organizados en un formato uniforme y consistente, lo que facilita su manipulaciÃ³n y anÃ¡lisis. En resumen, los principios de Tidy Data son:</p>
<p>En resumen, un tidy data sigue las siguientes caracterÃ­sticas:</p>
<ol type="1">
<li>Cada variable debe tener su <strong>propia columna</strong></li>
<li>Cada observaciÃ³n debe tener su <strong>propia fila</strong></li>
<li>Cada valor debe tener su <strong>propia celda</strong></li>
</ol>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/tidydata.png" class="img-fluid figure-img"></p>
</figure>
</div>
</section>
<section id="manipulaciÃ³n-de-datos-con-dplyr" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> ManipulaciÃ³n de datos con Dplyr</h1>
<p>El paquete Dplyr proporciona un conjunto coherente de funciones que permiten realizar operaciones comunes de manipulaciÃ³n de datos de manera <strong>intuitiva</strong> y eficaz. Estas funciones estÃ¡n optimizadas para trabajar con datos grandes y complejos, y permiten realizar tareas como filtrar <code>filter()</code> filas, seleccionar <code>select()</code> columnas, transformar valores <code>mutate()</code>, crear resÃºmenes <code>summerise()</code> y agrupar datos <code>group_by()</code> entre otras funciones. Las cinco funciones mas comunes que usaremos son:</p>
<ul>
<li><code>select()</code>: selecciona columnas de una tabla.</li>
<li><code>filter()</code>: selecciona (o filtra) filas de una tabla a partir de una o mÃ¡s condiciones lÃ³gicas.</li>
<li><code>group_by()</code>: agrupa una tabla en base al valor de una o mÃ¡s columnas.</li>
<li><code>mutate()</code>: agrega nuevas columnas a una tabla.</li>
<li><code>summarise()</code>: calcula estadÃ­sticas para cada grupo de una tabla.</li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Sobre la base de datos
</div>
</div>
<div class="callout-body-container callout-body">
<p><img src="img/pokemon_log.png" class="img-fluid" width="221"></p>
<p>Para esta secciÃ³n utilizaremos una versiÃ³n modificada de la base POKEMON de <a href="https://www.kaggle.com/datasets/rounakbanik/pokemon">Kaggle</a> y contiene la siguiente informaciÃ³n:</p>
<ul>
<li><strong>pokedex number</strong>: NÃºmero de identificador de cada pokÃ©mon</li>
<li><strong>Name</strong>: Nombre de cada PokÃ©mon</li>
<li><strong>Type</strong>: Tipo de PokÃ©mon, esto determina su resistencia o debilidad a los ataques</li>
<li><strong>HP</strong>: Hit Points, define que tanto daÃ±o puede tolerar un PokÃ©mon antes de desvanecerse</li>
<li><strong>Attack</strong>: Ataque</li>
<li><strong>Defense</strong>: Defensa</li>
<li><strong>SP Atk</strong>: Ataque especial</li>
<li><strong>SP Def</strong>: Defensa especial</li>
<li><strong>Speed</strong>: Velocidad. Determina cual PokÃ©mon ataca primero en cada ronda</li>
<li><strong>Weight</strong>: peso en kg Generatio: A cual generaciÃ³n pertenece</li>
<li><strong>is legendary</strong>: Si es legendario o no</li>
</ul>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(here)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(janitor)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>pokemon <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/pokemon.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 801 Columns: 13
â”€â”€ Column specification â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Delimiter: ","
chr  (2): NAME, type1
dbl (11): pokedex #, attack, defense, HP, percentage_male, sp_attack, sp_def...

â„¹ Use `spec()` to retrieve the full column specification for this data.
â„¹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>pokemon</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 801 Ã— 13
   `pokedex #` NAME    attack defense    HP percentage_male sp_attack sp_defense
         &lt;dbl&gt; &lt;chr&gt;    &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;           &lt;dbl&gt;     &lt;dbl&gt;      &lt;dbl&gt;
 1           1 Bulbasâ€¦     49      49    45            88.1        65         65
 2           2 Ivysaur     62      63    60            88.1        80         80
 3           3 Venusaâ€¦    100     123    80            88.1       122        120
 4           4 Charmaâ€¦     52      43    39            88.1        60         50
 5           5 Charmeâ€¦     64      58    58            88.1        80         65
 6           6 Charizâ€¦    104      78    78            88.1       159        115
 7           7 Squirtâ€¦     48      65    44            88.1        50         64
 8           8 Wartorâ€¦     63      80    59            88.1        65         80
 9           9 Blastoâ€¦    103     120    79            88.1       135        115
10          10 Caterpâ€¦     30      35    45            50          20         20
# â„¹ 791 more rows
# â„¹ 5 more variables: speed &lt;dbl&gt;, type1 &lt;chr&gt;, `weight kg` &lt;dbl&gt;,
#   generation &lt;dbl&gt;, `is legendary` &lt;dbl&gt;</code></pre>
</div>
</div>
<p>Vamos a correjir los nombres de las columnas con <strong>janitor</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>pokemon <span class="ot">&lt;-</span> <span class="fu">clean_names</span>(pokemon)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>pokemon</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 801 Ã— 13
   pokedex_number name       attack defense    hp percentage_male sp_attack
            &lt;dbl&gt; &lt;chr&gt;       &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;           &lt;dbl&gt;     &lt;dbl&gt;
 1              1 Bulbasaur      49      49    45            88.1        65
 2              2 Ivysaur        62      63    60            88.1        80
 3              3 Venusaur      100     123    80            88.1       122
 4              4 Charmander     52      43    39            88.1        60
 5              5 Charmeleon     64      58    58            88.1        80
 6              6 Charizard     104      78    78            88.1       159
 7              7 Squirtle       48      65    44            88.1        50
 8              8 Wartortle      63      80    59            88.1        65
 9              9 Blastoise     103     120    79            88.1       135
10             10 Caterpie       30      35    45            50          20
# â„¹ 791 more rows
# â„¹ 6 more variables: sp_defense &lt;dbl&gt;, speed &lt;dbl&gt;, type1 &lt;chr&gt;,
#   weight_kg &lt;dbl&gt;, generation &lt;dbl&gt;, is_legendary &lt;dbl&gt;</code></pre>
</div>
</div>
<section id="seleccionar-columnas-con-select" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="seleccionar-columnas-con-select"><span class="header-section-number">2.1</span> Seleccionar columnas con <code>select()</code></h2>
<p>Permite <strong>seleccionar</strong> una o varias columnas de un tibble o data.frame.</p>
<p>Por ejemplo, si queremos seleccionar solamente las columnas Name, y Attack</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(pokemon, name, attack)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 801 Ã— 2
   name       attack
   &lt;chr&gt;       &lt;dbl&gt;
 1 Bulbasaur      49
 2 Ivysaur        62
 3 Venusaur      100
 4 Charmander     52
 5 Charmeleon     64
 6 Charizard     104
 7 Squirtle       48
 8 Wartortle      63
 9 Blastoise     103
10 Caterpie       30
# â„¹ 791 more rows</code></pre>
</div>
</div>
<p>Recuerda que si queremos generar un nuevo objeto con ese subset de datos tenemos que asignarlo a otro objeto.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>pokemon_sub <span class="ot">&lt;-</span> <span class="fu">select</span>(pokemon, name, attack)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>pokemon_sub</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 801 Ã— 2
   name       attack
   &lt;chr&gt;       &lt;dbl&gt;
 1 Bulbasaur      49
 2 Ivysaur        62
 3 Venusaur      100
 4 Charmander     52
 5 Charmeleon     64
 6 Charizard     104
 7 Squirtle       48
 8 Wartortle      63
 9 Blastoise     103
10 Caterpie       30
# â„¹ 791 more rows</code></pre>
</div>
</div>
<p>Con <code>select()</code> tambien podemos seleccionar todo <strong>menos</strong> una columna especifica con el operador <code>-</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>pokemon_sub <span class="ot">&lt;-</span> <span class="fu">select</span>(pokemon, <span class="sc">-</span>attack)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>pokemon_sub</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 801 Ã— 12
   pokedex_number name  defense    hp percentage_male sp_attack sp_defense speed
            &lt;dbl&gt; &lt;chr&gt;   &lt;dbl&gt; &lt;dbl&gt;           &lt;dbl&gt;     &lt;dbl&gt;      &lt;dbl&gt; &lt;dbl&gt;
 1              1 Bulbâ€¦      49    45            88.1        65         65    45
 2              2 Ivysâ€¦      63    60            88.1        80         80    60
 3              3 Venuâ€¦     123    80            88.1       122        120    80
 4              4 Charâ€¦      43    39            88.1        60         50    65
 5              5 Charâ€¦      58    58            88.1        80         65    80
 6              6 Charâ€¦      78    78            88.1       159        115   100
 7              7 Squiâ€¦      65    44            88.1        50         64    43
 8              8 Wartâ€¦      80    59            88.1        65         80    58
 9              9 Blasâ€¦     120    79            88.1       135        115    78
10             10 Cateâ€¦      35    45            50          20         20    45
# â„¹ 791 more rows
# â„¹ 4 more variables: type1 &lt;chr&gt;, weight_kg &lt;dbl&gt;, generation &lt;dbl&gt;,
#   is_legendary &lt;dbl&gt;</code></pre>
</div>
</div>
<p>o podemos seleccionar un intervalo de columnas</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>pokemon_sub <span class="ot">&lt;-</span> <span class="fu">select</span>(pokemon, name, attack<span class="sc">:</span>hp)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>pokemon_sub</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 801 Ã— 4
   name       attack defense    hp
   &lt;chr&gt;       &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;
 1 Bulbasaur      49      49    45
 2 Ivysaur        62      63    60
 3 Venusaur      100     123    80
 4 Charmander     52      43    39
 5 Charmeleon     64      58    58
 6 Charizard     104      78    78
 7 Squirtle       48      65    44
 8 Wartortle      63      80    59
 9 Blastoise     103     120    79
10 Caterpie       30      35    45
# â„¹ 791 more rows</code></pre>
</div>
</div>
<p>o lo inverso para descargar un intervalo de columnas</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>pokemon_sub <span class="ot">&lt;-</span> <span class="fu">select</span>(pokemon, <span class="sc">-</span>(attack<span class="sc">:</span>hp))</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>pokemon_sub</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 801 Ã— 10
   pokedex_number name       percentage_male sp_attack sp_defense speed type1
            &lt;dbl&gt; &lt;chr&gt;                &lt;dbl&gt;     &lt;dbl&gt;      &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;
 1              1 Bulbasaur             88.1        65         65    45 grass
 2              2 Ivysaur               88.1        80         80    60 grass
 3              3 Venusaur              88.1       122        120    80 grass
 4              4 Charmander            88.1        60         50    65 fire 
 5              5 Charmeleon            88.1        80         65    80 fire 
 6              6 Charizard             88.1       159        115   100 fire 
 7              7 Squirtle              88.1        50         64    43 water
 8              8 Wartortle             88.1        65         80    58 water
 9              9 Blastoise             88.1       135        115    78 water
10             10 Caterpie              50          20         20    45 bug  
# â„¹ 791 more rows
# â„¹ 3 more variables: weight_kg &lt;dbl&gt;, generation &lt;dbl&gt;, is_legendary &lt;dbl&gt;</code></pre>
</div>
</div>
<p>La funciÃ³n <code>everything()</code> se puede seleccionar todo, y con esto es factible combiar el orden de las columnas. Por ejemplo, si queremos que la primera columna sea <code>type</code> ejecutamos:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(pokemon, type1, <span class="fu">everything</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 801 Ã— 13
   type1 pokedex_number name      attack defense    hp percentage_male sp_attack
   &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt;      &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;           &lt;dbl&gt;     &lt;dbl&gt;
 1 grass              1 Bulbasaur     49      49    45            88.1        65
 2 grass              2 Ivysaur       62      63    60            88.1        80
 3 grass              3 Venusaur     100     123    80            88.1       122
 4 fire               4 Charmandâ€¦     52      43    39            88.1        60
 5 fire               5 Charmeleâ€¦     64      58    58            88.1        80
 6 fire               6 Charizard    104      78    78            88.1       159
 7 water              7 Squirtle      48      65    44            88.1        50
 8 water              8 Wartortle     63      80    59            88.1        65
 9 water              9 Blastoise    103     120    79            88.1       135
10 bug               10 Caterpie      30      35    45            50          20
# â„¹ 791 more rows
# â„¹ 5 more variables: sp_defense &lt;dbl&gt;, speed &lt;dbl&gt;, weight_kg &lt;dbl&gt;,
#   generation &lt;dbl&gt;, is_legendary &lt;dbl&gt;</code></pre>
</div>
</div>
<section id="seleccionar-variables-con-un-patrÃ³n" class="level3" data-number="2.1.1">
<h3 data-number="2.1.1" class="anchored" data-anchor-id="seleccionar-variables-con-un-patrÃ³n"><span class="header-section-number">2.1.1</span> Seleccionar variables con un patrÃ³n</h3>
<p>Estas funcionen ayudad a seleccionar variables segÃºn un patrÃ³n determinado</p>
<ul>
<li><code>starts_with()</code>: Inicia con un prefijo exacto</li>
<li><code>ends_with()</code>: Finaliza con un sufijo exacto</li>
<li><code>contains()</code>: Contiene una cadena literal</li>
</ul>
<p>Por ejemplo, podemos seleccionar las columnas de Sp attack y Sp deffense utilizando el prefijo sp</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(pokemon, name, <span class="fu">starts_with</span>(<span class="st">"sp_"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 801 Ã— 3
   name       sp_attack sp_defense
   &lt;chr&gt;          &lt;dbl&gt;      &lt;dbl&gt;
 1 Bulbasaur         65         65
 2 Ivysaur           80         80
 3 Venusaur         122        120
 4 Charmander        60         50
 5 Charmeleon        80         65
 6 Charizard        159        115
 7 Squirtle          50         64
 8 Wartortle         65         80
 9 Blastoise        135        115
10 Caterpie          20         20
# â„¹ 791 more rows</code></pre>
</div>
</div>
<p>O podemos seleccionar las variables relacionadas con ataque (<em>attack</em>)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(pokemon, name, <span class="fu">contains</span>(<span class="st">"attack"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 801 Ã— 3
   name       attack sp_attack
   &lt;chr&gt;       &lt;dbl&gt;     &lt;dbl&gt;
 1 Bulbasaur      49        65
 2 Ivysaur        62        80
 3 Venusaur      100       122
 4 Charmander     52        60
 5 Charmeleon     64        80
 6 Charizard     104       159
 7 Squirtle       48        50
 8 Wartortle      63        65
 9 Blastoise     103       135
10 Caterpie       30        20
# â„¹ 791 more rows</code></pre>
</div>
</div>
</section>
</section>
<section id="filtrar-variables-con-filter" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="filtrar-variables-con-filter"><span class="header-section-number">2.2</span> Filtrar variables con <code>filter()</code></h2>
<p><img src="img/Horst_functions/filter.png" class="img-fluid"></p>
<p>La funciÃ³n <code>filter()</code> nos permite filtrar los elementos de una variable (columna) que cumplan con una condiciÃ³n especifica.</p>
<p>Por ejemplo, para filtrar pokemon que tengan un nivel de ataque (<em>Attack</em>) superior a 100 usariamos</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(pokemon, attack <span class="sc">&gt;</span> <span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 169 Ã— 13
   pokedex_number name       attack defense    hp percentage_male sp_attack
            &lt;dbl&gt; &lt;chr&gt;       &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;           &lt;dbl&gt;     &lt;dbl&gt;
 1              6 Charizard     104      78    78            88.1       159
 2              9 Blastoise     103     120    79            88.1       135
 3             15 Beedrill      150      40    65            50          15
 4             34 Nidoking      102      77    81           100          85
 5             57 Primeape      105      60    65            50          60
 6             59 Arcanine      110      80    90            75.4       100
 7             68 Machamp       130      80    90            75.4        65
 8             71 Victreebel    105      65    80            50         100
 9             76 Golem         120     130    80            50          55
10             85 Dodrio        110      70    60            50          60
# â„¹ 159 more rows
# â„¹ 6 more variables: sp_defense &lt;dbl&gt;, speed &lt;dbl&gt;, type1 &lt;chr&gt;,
#   weight_kg &lt;dbl&gt;, generation &lt;dbl&gt;, is_legendary &lt;dbl&gt;</code></pre>
</div>
</div>
<p>Para establecer varios condiciones, simplemente las podemos separar por una <code>,</code>. Por ejemplo, si queremos filtrar a los pokemon que tengan un nivel de ataque mayor a 100 y que sea de tipo fuego (<em>fire</em>)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(pokemon, attack <span class="sc">&gt;</span> <span class="dv">100</span>, type1 <span class="sc">==</span> <span class="st">"fire"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 11 Ã— 13
   pokedex_number name       attack defense    hp percentage_male sp_attack
            &lt;dbl&gt; &lt;chr&gt;       &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;           &lt;dbl&gt;     &lt;dbl&gt;
 1              6 Charizard     104      78    78            88.1       159
 2             59 Arcanine      110      80    90            75.4       100
 3            136 Flareon       130      60    65            88.1        95
 4            244 Entei         115      85   115            NA          90
 5            250 Ho-Oh         130      90   106            NA         110
 6            257 Blaziken      160      80    80            88.1       130
 7            323 Camerupt      120     100    70            50         145
 8            392 Infernape     104      71    76            88.1       104
 9            500 Emboar        123      65   110            88.1       100
10            721 Volcanion     110     120    80            NA         130
11            727 Incineroar    115      90    95            88.1        80
# â„¹ 6 more variables: sp_defense &lt;dbl&gt;, speed &lt;dbl&gt;, type1 &lt;chr&gt;,
#   weight_kg &lt;dbl&gt;, generation &lt;dbl&gt;, is_legendary &lt;dbl&gt;</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>Si tienes muchas condiciones, puedes escribir cada condiciÃ³n en una lÃ­nea diferente para evitar lÃ­neas de cÃ³digo muy largas</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(pokemon, attack <span class="sc">&gt;</span> <span class="dv">100</span>,</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>       type1 <span class="sc">==</span> <span class="st">"fire"</span>,</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>       generation <span class="sc">==</span> <span class="dv">1</span>, </span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>       speed <span class="sc">&gt;</span> <span class="dv">50</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>Si queremos filtrar distintas condiciones de una misma variable (columna) podemos usar el operador <code>%in%</code>.</p>
<p>Por ejemplo, para filtar los pokemon que sean de tipo fuego <strong>y</strong> agua</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(pokemon, type1 <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"fire"</span>, <span class="st">"water"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 166 Ã— 13
   pokedex_number name       attack defense    hp percentage_male sp_attack
            &lt;dbl&gt; &lt;chr&gt;       &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;           &lt;dbl&gt;     &lt;dbl&gt;
 1              4 Charmander     52      43    39            88.1        60
 2              5 Charmeleon     64      58    58            88.1        80
 3              6 Charizard     104      78    78            88.1       159
 4              7 Squirtle       48      65    44            88.1        50
 5              8 Wartortle      63      80    59            88.1        65
 6              9 Blastoise     103     120    79            88.1       135
 7             37 Vulpix         41      40    38            24.6        50
 8             38 Ninetales      67      75    73            24.6        81
 9             54 Psyduck        52      48    50            50          65
10             55 Golduck        82      78    80            50          95
# â„¹ 156 more rows
# â„¹ 6 more variables: sp_defense &lt;dbl&gt;, speed &lt;dbl&gt;, type1 &lt;chr&gt;,
#   weight_kg &lt;dbl&gt;, generation &lt;dbl&gt;, is_legendary &lt;dbl&gt;</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Nota
</div>
</div>
<div class="callout-body-container callout-body">
<p>Si tienes muchas condiciones o si tienes las mismas condiciones que quieres filtrar en distintos sets de datos, puedes hacer un vector y despues incorporarlo en la funcion filter. Por ejemplo</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>tipos <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"fire"</span>, <span class="st">"normal"</span>, <span class="st">"water"</span>)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(pokemon, type1 <span class="sc">%in%</span> tipos)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 271 Ã— 13
   pokedex_number name       attack defense    hp percentage_male sp_attack
            &lt;dbl&gt; &lt;chr&gt;       &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;           &lt;dbl&gt;     &lt;dbl&gt;
 1              4 Charmander     52      43    39            88.1        60
 2              5 Charmeleon     64      58    58            88.1        80
 3              6 Charizard     104      78    78            88.1       159
 4              7 Squirtle       48      65    44            88.1        50
 5              8 Wartortle      63      80    59            88.1        65
 6              9 Blastoise     103     120    79            88.1       135
 7             16 Pidgey         45      40    40            50          35
 8             17 Pidgeotto      60      55    63            50          50
 9             18 Pidgeot        80      80    83            50         135
10             19 Rattata        56      35    30            50          25
# â„¹ 261 more rows
# â„¹ 6 more variables: sp_defense &lt;dbl&gt;, speed &lt;dbl&gt;, type1 &lt;chr&gt;,
#   weight_kg &lt;dbl&gt;, generation &lt;dbl&gt;, is_legendary &lt;dbl&gt;</code></pre>
</div>
</div>
</div>
</div>
<p>Es posbile filtrar un intervalo de valores utilizando la funciÃ³n <code>between()</code>. Esta funciÃ³n requiere como argumentos el nombre de la variable que queremos filtrar, el lÃ­mite inferior y el lÃ­mite superior.</p>
<p>Por ejemplo, si queremos filtrar los pokemon que tengan un nivel de ataque (<em>attack</em>) mayor a 100 pero menor a 150</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(pokemon, <span class="fu">between</span>(attack, <span class="dv">100</span>, <span class="dv">150</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 191 Ã— 13
   pokedex_number name      attack defense    hp percentage_male sp_attack
            &lt;dbl&gt; &lt;chr&gt;      &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;           &lt;dbl&gt;     &lt;dbl&gt;
 1              3 Venusaur     100     123    80            88.1       122
 2              6 Charizard    104      78    78            88.1       159
 3              9 Blastoise    103     120    79            88.1       135
 4             15 Beedrill     150      40    65            50          15
 5             28 Sandslash    100     120    75            50          25
 6             34 Nidoking     102      77    81           100          85
 7             51 Dugtrio      100      60    35            50          50
 8             57 Primeape     105      60    65            50          60
 9             59 Arcanine     110      80    90            75.4       100
10             67 Machoke      100      70    80            75.4        50
# â„¹ 181 more rows
# â„¹ 6 more variables: sp_defense &lt;dbl&gt;, speed &lt;dbl&gt;, type1 &lt;chr&gt;,
#   weight_kg &lt;dbl&gt;, generation &lt;dbl&gt;, is_legendary &lt;dbl&gt;</code></pre>
</div>
</div>
<p>Podemos usar la operaciÃ³n opuesta utilizando el operado <code>!</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(pokemon, <span class="sc">!</span><span class="fu">between</span>(attack, <span class="dv">100</span>, <span class="dv">150</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 610 Ã— 13
   pokedex_number name       attack defense    hp percentage_male sp_attack
            &lt;dbl&gt; &lt;chr&gt;       &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;           &lt;dbl&gt;     &lt;dbl&gt;
 1              1 Bulbasaur      49      49    45            88.1        65
 2              2 Ivysaur        62      63    60            88.1        80
 3              4 Charmander     52      43    39            88.1        60
 4              5 Charmeleon     64      58    58            88.1        80
 5              7 Squirtle       48      65    44            88.1        50
 6              8 Wartortle      63      80    59            88.1        65
 7             10 Caterpie       30      35    45            50          20
 8             11 Metapod        20      55    50            50          25
 9             12 Butterfree     45      50    60            50          90
10             13 Weedle         35      50    40            50          20
# â„¹ 600 more rows
# â„¹ 6 more variables: sp_defense &lt;dbl&gt;, speed &lt;dbl&gt;, type1 &lt;chr&gt;,
#   weight_kg &lt;dbl&gt;, generation &lt;dbl&gt;, is_legendary &lt;dbl&gt;</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-caution no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<strong>Ejercicio: Â¿Â¡QUIEN ES ESE POKEMON!?</strong> ðŸ“£
</div>
</div>
<div class="callout-body-container callout-body">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/jigglypuff.png" class="img-fluid figure-img" width="500"></p>
</figure>
</div>
<p>Nuestro pokÃ©mon tiene un valor de HP entre 100 y 200; valor de velocidad menor a 50; es del tipo1 Normal; tiene un valor de defensa menor a 40 y pertenece a la primera generaciÃ³n</p>
<div class="cell">
<details>
<summary>ver codigo</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(pokemon, <span class="fu">between</span>(hp, <span class="dv">100</span>, <span class="dv">200</span>),</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>       speed <span class="sc">&lt;</span> <span class="dv">50</span>,</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>       type1 <span class="sc">==</span> <span class="st">"normal"</span>,</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>       defense <span class="sc">&lt;</span> <span class="dv">40</span>,</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>       generation <span class="sc">==</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
<section id="filtrar-variables-con-un-patrÃ³n" class="level3" data-number="2.2.1">
<h3 data-number="2.2.1" class="anchored" data-anchor-id="filtrar-variables-con-un-patrÃ³n"><span class="header-section-number">2.2.1</span> Filtrar variables con un patrÃ³n</h3>
<p>Tambien es posible filtrar una variable a partir de un caracter en especifico usando la funciÃ³n <code>str_detect()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(pokemon, <span class="fu">str_detect</span>(name, <span class="st">"eon"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 13 Ã— 13
   pokedex_number name       attack defense    hp percentage_male sp_attack
            &lt;dbl&gt; &lt;chr&gt;       &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;           &lt;dbl&gt;     &lt;dbl&gt;
 1              5 Charmeleon     64      58    58            88.1        80
 2            134 Vaporeon       65      60   130            88.1       110
 3            135 Jolteon        65      60    65            88.1       110
 4            136 Flareon       130      60    65            88.1        95
 5            196 Espeon         65      60    65            88.1       130
 6            197 Umbreon        65     110    95            88.1        60
 7            352 Kecleon        90      70    60            50          60
 8            395 Empoleon       86      88    84            88.1       111
 9            456 Finneon        49      56    49            50          49
10            457 Lumineon       69      76    69            50          69
11            470 Leafeon       110     130    65            88.1        60
12            471 Glaceon        60     110    65            88.1       130
13            700 Sylveon        65      65    95            88.1       110
# â„¹ 6 more variables: sp_defense &lt;dbl&gt;, speed &lt;dbl&gt;, type1 &lt;chr&gt;,
#   weight_kg &lt;dbl&gt;, generation &lt;dbl&gt;, is_legendary &lt;dbl&gt;</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-caution no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Ejercicio: Una galaxÃ­a muy lejanaâ€¦
</div>
</div>
<div class="callout-body-container callout-body">
<p>Abre la tabla <code>starwars</code> que se encuentra en el directorio de <em>databases</em> y genera los siguientes objetos:</p>
<ol type="1">
<li>Una tabla que incluya solamente el nombre del personaje y todas las variables relacionadas con colores.</li>
<li>Una tabla que incluya solamente los personajes femeninos del planeta Naboo.</li>
<li>Una tabla con los personajes que hayan aparecido en <em>Attack of the Clones</em>.</li>
</ol>
</div>
</div>
</section>
</section>
<section id="transformar-o-crear-columnas-con-mutate" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="transformar-o-crear-columnas-con-mutate"><span class="header-section-number">2.3</span> Transformar o crear columnas con <code>mutate()</code></h2>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/Horst_functions/mutate.png" class="img-fluid figure-img" width="500"></p>
</figure>
</div>
<p>La funciÃ³n <code>mutate()</code> es una funciÃ³n versatil en el sentido que nos permite crear nuevas variables que contengan alguna operaciÃ³n a partir de las que ya tenemos, aÃ±adir una nueva variable o transformar una variable ya existente</p>
<p>Por ejemplo, podemos generar una nueva columna llamada â€œat_df_ratioâ€ con la propociÃ³n de los valores de Ataque sobre Defensa</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>pokemon_mutate <span class="ot">&lt;-</span> <span class="fu">mutate</span>(pokemon, <span class="at">at_df_ratio =</span> attack<span class="sc">/</span>defense )</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(pokemon_mutate<span class="sc">$</span>at_df_ratio)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.0000000 0.9841270 0.8130081 1.2093023 1.1034483 1.3333333</code></pre>
</div>
</div>
<p>De igual manera, se pueden generar diversas nuevas columnas en una misma funciÃ³n separadas por comas.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>pokemon_mutate <span class="ot">&lt;-</span> <span class="fu">mutate</span>(pokemon, </span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>                         <span class="at">at_df_ratio =</span> attack<span class="sc">/</span>defense,</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>                         <span class="at">at_df_per =</span> at_df_ratio <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>                         <span class="at">nueva_col =</span> <span class="st">"nueva columna"</span>)</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>pokemon_mutate</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 801 Ã— 16
   pokedex_number name       attack defense    hp percentage_male sp_attack
            &lt;dbl&gt; &lt;chr&gt;       &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;           &lt;dbl&gt;     &lt;dbl&gt;
 1              1 Bulbasaur      49      49    45            88.1        65
 2              2 Ivysaur        62      63    60            88.1        80
 3              3 Venusaur      100     123    80            88.1       122
 4              4 Charmander     52      43    39            88.1        60
 5              5 Charmeleon     64      58    58            88.1        80
 6              6 Charizard     104      78    78            88.1       159
 7              7 Squirtle       48      65    44            88.1        50
 8              8 Wartortle      63      80    59            88.1        65
 9              9 Blastoise     103     120    79            88.1       135
10             10 Caterpie       30      35    45            50          20
# â„¹ 791 more rows
# â„¹ 9 more variables: sp_defense &lt;dbl&gt;, speed &lt;dbl&gt;, type1 &lt;chr&gt;,
#   weight_kg &lt;dbl&gt;, generation &lt;dbl&gt;, is_legendary &lt;dbl&gt;, at_df_ratio &lt;dbl&gt;,
#   at_df_per &lt;dbl&gt;, nueva_col &lt;chr&gt;</code></pre>
</div>
</div>
<p>Con <code>mutate()</code>, tambiÃ©n es posible cambiar el tipo de dato de cada columna. Por ejemplo, cambiar la columna â€œType1â€ de carÃ¡cter a factor:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>pokemon_mutate <span class="ot">&lt;-</span> <span class="fu">mutate</span>(pokemon, <span class="at">type1 =</span> <span class="fu">factor</span>(type1))</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>pokemon_mutate</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 801 Ã— 13
   pokedex_number name       attack defense    hp percentage_male sp_attack
            &lt;dbl&gt; &lt;chr&gt;       &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;           &lt;dbl&gt;     &lt;dbl&gt;
 1              1 Bulbasaur      49      49    45            88.1        65
 2              2 Ivysaur        62      63    60            88.1        80
 3              3 Venusaur      100     123    80            88.1       122
 4              4 Charmander     52      43    39            88.1        60
 5              5 Charmeleon     64      58    58            88.1        80
 6              6 Charizard     104      78    78            88.1       159
 7              7 Squirtle       48      65    44            88.1        50
 8              8 Wartortle      63      80    59            88.1        65
 9              9 Blastoise     103     120    79            88.1       135
10             10 Caterpie       30      35    45            50          20
# â„¹ 791 more rows
# â„¹ 6 more variables: sp_defense &lt;dbl&gt;, speed &lt;dbl&gt;, type1 &lt;fct&gt;,
#   weight_kg &lt;dbl&gt;, generation &lt;dbl&gt;, is_legendary &lt;dbl&gt;</code></pre>
</div>
</div>
</section>
</section>
<section id="pipes-y" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Pipes <em>%&gt;%</em> y <em>|&gt;</em></h1>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/pipe.png" class="img-fluid figure-img"></p>
</figure>
</div>
<p>El operador %&gt;% nos permite aplicar una serie de funciones secuenciales a un objeto sin tener que ir creando variables para uso temporal o sin tener que anidar funciones.</p>
<p>Dplyr importa este operador de otro paquete (magrittr). De manera general, el operador permite unir el resultado de una funciÃ³n a la entrada de otra funciÃ³n.</p>
<p>Por ejemplo, si yo quiere filtrar los pokemon con valor de ataque mayor a 100, seleccionar las columnas Name y Attack y posteriormente mostrar solo las primeras seis filas (head) tendria que correr la siguiente linea:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">select</span>(<span class="fu">filter</span>(pokemon, attack <span class="sc">&lt;</span> <span class="dv">100</span>), name, attack))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 Ã— 2
  name       attack
  &lt;chr&gt;       &lt;dbl&gt;
1 Bulbasaur      49
2 Ivysaur        62
3 Charmander     52
4 Charmeleon     64
5 Squirtle       48
6 Wartortle      63</code></pre>
</div>
</div>
<p>Usando pipes, podemos reescribir esta secuencia de funciones asi:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>pokemon <span class="sc">|&gt;</span> </span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(attack <span class="sc">&lt;</span> <span class="dv">100</span>) <span class="sc">%&gt;%</span>  </span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(name, attack) <span class="sc">%&gt;%</span>  </span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 Ã— 2
  name       attack
  &lt;chr&gt;       &lt;dbl&gt;
1 Bulbasaur      49
2 Ivysaur        62
3 Charmander     52
4 Charmeleon     64
5 Squirtle       48
6 Wartortle      63</code></pre>
</div>
</div>
<p>Los resultados de esta cadena, pueden asignarse a una nueva variable</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>pokemon_pipe <span class="ot">&lt;-</span> pokemon <span class="sc">%&gt;%</span>  </span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(attack <span class="sc">&lt;</span> <span class="dv">100</span>) <span class="sc">%&gt;%</span>  </span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(name, attack) <span class="sc">%&gt;%</span>  </span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Catsup, Ketchup; %&gt;% , |&gt;
</div>
</div>
<div class="callout-body-container callout-body">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/catsup_pipes.png" class="img-fluid figure-img" width="361"></p>
</figure>
</div>
<p>Desde su versiÃ³n 4.1.0, R incluye un pipe nativo <code>|&gt;</code>. El comportamiento de ambos pipes es en gran medida el mismo, permitiendo expresar una secuencia de operaciones a un objeto, existen algunas diferencias que se discuten en <a href="https://www.tidyverse.org/blog/2023/04/base-vs-magrittr-pipe/">este articulo</a>.</p>
<p>Para fines de este curso, nos enfocaremos a usar el pipe de <strong>magritrr</strong>.</p>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>Para escribir rÃ¡pidamente el operador <code>%&gt;%</code> teclea Ctrl+shift+M</p>
</div>
</div>
<div class="callout callout-style-default callout-caution no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Ejercicio: PingÃ¼inos
</div>
</div>
<div class="callout-body-container callout-body">
<p>Abre la tabla <code>palmer_penguis.csv</code> que se encuentra en el directorio de <em>databases</em> y utilizando pipies genera los siguientes objetos:</p>
<ol type="1">
<li>Una tabla con los pingÃ¼inos de la especie Adelie y que incluya una columna con la proporciÃ³n (ratio) entre la longitud y profundidad del pico.</li>
<li>Una tabla con solamente los individuos hembras de culquier especie y que solamente contenta las columnas de <em>especie</em>, <em>isla</em> y peso corporal <strong>en Kg</strong>.</li>
<li>Una tabla que contenga a los individuos machos de la especie Gentoo con un peso corporal mayor a 4 Kg. Convierte la columna isla a factor.</li>
</ol>
<div class="cell">
<details>
<summary>ver codigo</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>penguins <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/palmer_penguins.csv"</span>)</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a><span class="co"># ejercicio 1</span></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>penguins_e1 <span class="ot">&lt;-</span> penguins <span class="sc">%&gt;%</span> </span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(species <span class="sc">==</span> <span class="st">"Adelie"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">bill_ratio =</span> bill_length_mm <span class="sc">/</span> bill_depth_mm)</span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a><span class="co"># ejercicio 2</span></span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>penguins_e2 <span class="ot">&lt;-</span> penguins <span class="sc">%&gt;%</span> </span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(sex <span class="sc">==</span> <span class="st">"female"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">body_mass_kg =</span> body_mass_g <span class="sc">/</span> <span class="dv">1000</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(species, island, body_mass_kg)</span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a><span class="co"># ejercicio 3</span></span>
<span id="cb51-15"><a href="#cb51-15" aria-hidden="true" tabindex="-1"></a>penguins_e3 <span class="ot">&lt;-</span> penguins <span class="sc">%&gt;%</span> </span>
<span id="cb51-16"><a href="#cb51-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">island =</span> <span class="fu">factor</span>(island),</span>
<span id="cb51-17"><a href="#cb51-17" aria-hidden="true" tabindex="-1"></a>         <span class="at">body_mass_kg =</span> body_mass_g <span class="sc">/</span> <span class="dv">1000</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb51-18"><a href="#cb51-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(species <span class="sc">==</span> <span class="st">"Gentoo"</span>,</span>
<span id="cb51-19"><a href="#cb51-19" aria-hidden="true" tabindex="-1"></a>         sex <span class="sc">==</span> <span class="st">"male"</span>,</span>
<span id="cb51-20"><a href="#cb51-20" aria-hidden="true" tabindex="-1"></a>         body_mass_kg <span class="sc">&gt;</span> <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</section>
<section id="resumen-de-los-datos-summarise-y-group_by." class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Resumen de los datos; <code>summarise()</code> y <code>group_by()</code>.</h1>
<p>Un elemento importante en el anÃ¡lisis exploratorio de datos es poder agrupar y resumir para obtener informaciÃ³n relevante del set de datos. El promedio y la desviaciÃ³n estÃ¡ndar son ejemplos de esto. AdemÃ¡s, agrupar los datos de acuerdo a alguna caracteristica permite obtener resultados mas informativos.</p>
<p>Para hacer un resumen (<em>summary</em>) de una determinada variable en los datos podemos utilizar la funciÃ³n <code>summarise()</code> que a su vez nos permite aplicar una funciÃ³n (mean, sd, min, max) a una variable.</p>
<p>Por ejemplo, para obtener el peso promedio en g de los pingÃ¼inos, podemos aplicar la funciÃ³n de la siguiente forma:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>penguins <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/palmer_penguins.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 344 Columns: 8
â”€â”€ Column specification â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Delimiter: ","
chr (3): species, island, sex
dbl (5): bill_length_mm, bill_depth_mm, flipper_length_mm, body_mass_g, year

â„¹ Use `spec()` to retrieve the full column specification for this data.
â„¹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">%&gt;%</span> </span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">promedio =</span> <span class="fu">mean</span>(body_mass_g, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 Ã— 1
  promedio
     &lt;dbl&gt;
1    4202.</code></pre>
</div>
</div>
<p>o aplicar el promedio y desviaciÃ³n estandar</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">%&gt;%</span> </span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">promedio =</span> <span class="fu">mean</span>(body_mass_g, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">desviacion =</span> <span class="fu">sd</span>(body_mass_g, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 Ã— 2
  promedio desviacion
     &lt;dbl&gt;      &lt;dbl&gt;
1    4202.       802.</code></pre>
</div>
</div>
<section id="operaciones-agrupadas" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="operaciones-agrupadas"><span class="header-section-number">4.1</span> Operaciones agrupadas</h2>
<p>Considerando la base de datos, seria mas informativo obtener el promedio por especie o por isla. La funciÃ³n <code>group_by()</code> permite agrupar los datos de acuerdo a alguna variable (factor).</p>
<p>Por ejemplo, para obtener el peso promedio por especie:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">%&gt;%</span> </span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(species) <span class="sc">%&gt;%</span> </span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">promedio_peso =</span> <span class="fu">mean</span>(body_mass_g, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 Ã— 2
  species   promedio_peso
  &lt;chr&gt;             &lt;dbl&gt;
1 Adelie            3701.
2 Chinstrap         3733.
3 Gentoo            5076.</code></pre>
</div>
</div>
<p>Podemos agrupar utilizando mas variables separadas por una coma:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">%&gt;%</span> </span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(island, species, sex) <span class="sc">%&gt;%</span> </span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">promedio_peso =</span> <span class="fu">mean</span>(body_mass_g, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">desviacion =</span> <span class="fu">sd</span>(body_mass_g, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">N =</span> <span class="fu">n</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'island', 'species'. You can override using
the `.groups` argument.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 13 Ã— 6
# Groups:   island, species [5]
   island    species   sex    promedio_peso desviacion     N
   &lt;chr&gt;     &lt;chr&gt;     &lt;chr&gt;          &lt;dbl&gt;      &lt;dbl&gt; &lt;int&gt;
 1 Biscoe    Adelie    female         3369.       343.    22
 2 Biscoe    Adelie    male           4050        356.    22
 3 Biscoe    Gentoo    female         4680.       282.    58
 4 Biscoe    Gentoo    male           5485.       313.    61
 5 Biscoe    Gentoo    &lt;NA&gt;           4588.       338.     5
 6 Dream     Adelie    female         3344.       212.    27
 7 Dream     Adelie    male           4046.       331.    28
 8 Dream     Adelie    &lt;NA&gt;           2975         NA      1
 9 Dream     Chinstrap female         3527.       285.    34
10 Dream     Chinstrap male           3939.       362.    34
11 Torgersen Adelie    female         3396.       259.    24
12 Torgersen Adelie    male           4035.       372.    23
13 Torgersen Adelie    &lt;NA&gt;           3681.       413.     5</code></pre>
</div>
</div>
<p>Existen otras funciones Ãºtiles por las que nos podrÃ­a interesar agrupar</p>
<ul>
<li><code>count()</code></li>
<li><code>mean()</code></li>
<li><code>median()</code></li>
<li><code>min()</code></li>
<li><code>max()</code></li>
<li><code>quantile(x, 0.25)</code></li>
<li><code>IQR()</code></li>
</ul>
<p>El uso de la funciÃ³n <code>group_by()</code> tambien nos permite transformar una variable e incluirla en una columna en conjunto con la funciÃ³n <code>mutate()</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">%&gt;%</span> </span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(species, island,sex) <span class="sc">%&gt;%</span> </span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">promedio_peso_grupo =</span> <span class="fu">mean</span>(body_mass_g, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(promedio_peso_grupo, <span class="fu">everything</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 344 Ã— 9
# Groups:   species, island, sex [13]
   promedio_peso_grupo species island    bill_length_mm bill_depth_mm
                 &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;              &lt;dbl&gt;         &lt;dbl&gt;
 1               4035. Adelie  Torgersen           39.1          18.7
 2               3396. Adelie  Torgersen           39.5          17.4
 3               3396. Adelie  Torgersen           40.3          18  
 4               3681. Adelie  Torgersen           NA            NA  
 5               3396. Adelie  Torgersen           36.7          19.3
 6               4035. Adelie  Torgersen           39.3          20.6
 7               3396. Adelie  Torgersen           38.9          17.8
 8               4035. Adelie  Torgersen           39.2          19.6
 9               3681. Adelie  Torgersen           34.1          18.1
10               3681. Adelie  Torgersen           42            20.2
# â„¹ 334 more rows
# â„¹ 4 more variables: flipper_length_mm &lt;dbl&gt;, body_mass_g &lt;dbl&gt;, sex &lt;chr&gt;,
#   year &lt;dbl&gt;</code></pre>
</div>
</div>
</section>
<section id="resumir-todas-las-variables-con-summarise_all" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="resumir-todas-las-variables-con-summarise_all"><span class="header-section-number">4.2</span> Resumir todas las variables con <code>summarise_all()</code></h2>
<p>La funciÃ³n <code>summarise_all()</code> requiere una funciÃ³n como argumento, la cual aplica a todas las columnas de la tabla. En este ejemplo se agrego el argumento na.rm = TRUE el cual ignora los NAs</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">%&gt;%</span> </span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(species, island, sex) <span class="sc">%&gt;%</span> </span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_all</span>(mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 13 Ã— 8
# Groups:   species, island [5]
   species   island    sex    bill_length_mm bill_depth_mm flipper_length_mm
   &lt;chr&gt;     &lt;chr&gt;     &lt;chr&gt;           &lt;dbl&gt;         &lt;dbl&gt;             &lt;dbl&gt;
 1 Adelie    Biscoe    female           37.4          17.7              187.
 2 Adelie    Biscoe    male             40.6          19.0              190.
 3 Adelie    Dream     female           36.9          17.6              188.
 4 Adelie    Dream     male             40.1          18.8              192.
 5 Adelie    Dream     &lt;NA&gt;             37.5          18.9              179 
 6 Adelie    Torgersen female           37.6          17.6              188.
 7 Adelie    Torgersen male             40.6          19.4              195.
 8 Adelie    Torgersen &lt;NA&gt;             37.9          18.2              187.
 9 Chinstrap Dream     female           46.6          17.6              192.
10 Chinstrap Dream     male             51.1          19.3              200.
11 Gentoo    Biscoe    female           45.6          14.2              213.
12 Gentoo    Biscoe    male             49.5          15.7              222.
13 Gentoo    Biscoe    &lt;NA&gt;             45.6          14.6              216.
# â„¹ 2 more variables: body_mass_g &lt;dbl&gt;, year &lt;dbl&gt;</code></pre>
</div>
</div>
</section>
</section>
<section id="count" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> <code>count()</code></h1>
<p>La funciÃ³n <code>count()</code> nos permite saber cuantas observaciones hay en una variable especifica. Al agregar el argumento sort = TRUEdevuelve una tabla descendiente con el nÃºmero de observaciones.</p>
<p>Regresemos a la base de datos de star wars y evaluemos cuantos personajes hay de cada planeta.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>starwars <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/starwars.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 87 Columns: 14
â”€â”€ Column specification â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Delimiter: ","
chr (11): name, hair_color, skin_color, eye_color, sex, gender, homeworld, s...
dbl  (3): height, mass, birth_year

â„¹ Use `spec()` to retrieve the full column specification for this data.
â„¹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>starwars <span class="sc">%&gt;%</span> </span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(homeworld, <span class="at">sort =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 49 Ã— 2
   homeworld     n
   &lt;chr&gt;     &lt;int&gt;
 1 Naboo        11
 2 Tatooine     10
 3 &lt;NA&gt;         10
 4 Alderaan      3
 5 Coruscant     3
 6 Kamino        3
 7 Corellia      2
 8 Kashyyyk      2
 9 Mirial        2
10 Ryloth        2
# â„¹ 39 more rows</code></pre>
</div>
</div>
<p>Tambien es posible hacer contenos anidados incluyendo mas variables separadas por comas:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>starwars <span class="sc">%&gt;%</span> </span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(species, homeworld, <span class="at">sort =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 58 Ã— 3
   species  homeworld     n
   &lt;chr&gt;    &lt;chr&gt;     &lt;int&gt;
 1 Human    Tatooine      8
 2 Human    Naboo         5
 3 Human    &lt;NA&gt;          5
 4 Droid    &lt;NA&gt;          3
 5 Gungan   Naboo         3
 6 Human    Alderaan      3
 7 Droid    Tatooine      2
 8 Human    Corellia      2
 9 Human    Coruscant     2
10 Kaminoan Kamino        2
# â„¹ 48 more rows</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>Por default, la funciÃ³n <code>count()</code> nombra <em>n</em> al nÃºmero de items de cada groupo. Eso se puede modificar agregando el parÃ¡metro <code>name</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>starwars <span class="sc">%&gt;%</span> </span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(species, <span class="at">sort =</span> <span class="cn">TRUE</span>, <span class="at">name =</span> <span class="st">"otros"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 38 Ã— 2
   species  otros
   &lt;chr&gt;    &lt;int&gt;
 1 Human       35
 2 Droid        6
 3 &lt;NA&gt;         4
 4 Gungan       3
 5 Kaminoan     2
 6 Mirialan     2
 7 Twi'lek      2
 8 Wookiee      2
 9 Zabrak       2
10 Aleena       1
# â„¹ 28 more rows</code></pre>
</div>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>starwars  <span class="sc">%&gt;%</span> </span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sp =</span> <span class="fu">fct_lump_min</span>(species, <span class="dv">2</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(sp, <span class="at">sort =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 Ã— 2
   sp           n
   &lt;fct&gt;    &lt;int&gt;
 1 Human       35
 2 Other       29
 3 Droid        6
 4 &lt;NA&gt;         4
 5 Gungan       3
 6 Kaminoan     2
 7 Mirialan     2
 8 Twi'lek      2
 9 Wookiee      2
10 Zabrak       2</code></pre>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "î§‹";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>